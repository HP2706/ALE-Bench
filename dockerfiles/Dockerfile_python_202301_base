FROM python:3.11.4-slim-bookworm

LABEL org.opencontainers.image.source=https://github.com/SakanaAI/ALE-Bench

# Install build dependencies and GNU time for performance measurement
RUN apt-get update && \
    apt-get install -y --no-install-recommends build-essential cmake git libgmp-dev libmpfr-dev libmpc-dev time && \
    apt-get autoremove -y && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# Install Python packages
RUN python3.11 -m pip install --no-cache-dir \
    numpy==1.24.1 \
    scipy==1.10.1 \
    networkx==3.0 \
    sympy==1.11.1 \
    sortedcontainers==2.4.0  \
    more-itertools==9.0.0 \
    shapely==2.0.0 \
    bitarray==2.6.2 \
    PuLP==2.7.0 \
    mpmath==1.2.1 \
    pandas==1.5.2 \
    z3-solver==4.12.1.0 \
    scikit-learn==1.2.0 \
    ortools==9.5.2237 \
    polars==0.15.15 \
    lightgbm==3.3.1 \
    gmpy2==2.1.5 \
    numba==0.57.0 \
    git+https://github.com/not522/ac-library-python && \
    python3.11 -m pip install --no-cache-dir torch==1.13.1+cpu --extra-index-url https://download.pytorch.org/whl/cpu && \
    python3.11 -m pip install --no-cache-dir -U setuptools==66.0.0 && \
    python3.11 -m pip install --no-cache-dir cppyy==2.4.1 && \
    # Check the installed packages
    python3.11 -c "import numpy, scipy, networkx, sympy, sortedcontainers, more_itertools, shapely, bitarray, pulp, mpmath, pandas, z3, sklearn, ortools, polars, lightgbm, gmpy2, numba, atcoder, torch, setuptools, cppyy"

WORKDIR /workdir
