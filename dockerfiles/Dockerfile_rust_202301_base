FROM rust:1.70.0-slim-bookworm

LABEL org.opencontainers.image.source=https://github.com/SakanaAI/ALE-Bench

# Install GNU time for performance measurement
RUN apt-get update && \
    apt-get install -y --no-install-recommends time && \
    apt-get autoremove -y && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

COPY ./rust_202301_config.toml ./.cargo/config.toml

# Install dependencies
WORKDIR /workdir

COPY ./rust_202301_Cargo.toml ./Cargo.toml
COPY ./rust_202301_Cargo.lock ./Cargo.lock

RUN mkdir ./src && \
    echo 'fn main() {}' > ./src/main.rs && \
    cargo build -vv --release && \
    rm target/release/main
